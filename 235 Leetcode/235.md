Lowest Common Ancestor in a Binary Search Tree (BST)

Problem Statement

Given a Binary Search Tree (BST) and two nodes p and q, find the Lowest Common Ancestor (LCA) of these two nodes.

Example

Consider the following BST:

        6
       / \
      2   8
     / \ / \
    0  4 7 9
      / \
     3   5

Let’s find the LCA of nodes 2 and 8.

Solution Code

class Solution:
    def lowestCommonAncestor(self, root: 'TreeNode', p: 'TreeNode', q: 'TreeNode') -> 'TreeNode':
        cur = root  # Start traversal from the root of the BST (node 6)
        
        while cur:  # Continue searching while the current node is not None
            if p.val > cur.val and q.val > cur.val:
                # If both p and q are greater than the current node, move to the right subtree
                cur = cur.right  
            elif p.val < cur.val and q.val < cur.val:
                # If both p and q are smaller than the current node, move to the left subtree
                cur = cur.left  
            else:  
                # If one node is on the left and the other is on the right, or if cur is p or q,
                # then cur is the lowest common ancestor
                return cur  

Step-by-Step Execution

Step 1: Initialize Root

Start at cur = root, which is node 6.

Step 2: Compare p and q with cur

p = 2, q = 8

Since p < 6 and q > 6, we found the split point.

The LCA is node 6.

Final Answer

The LCA of nodes 2 and 8 is node 6.

Another Example

Find the LCA of nodes 2 and 4

p = 2, q = 4

Start at node 6:

Both p and q are smaller → Move to the left subtree (node 2).

At node 2:

p = 2, q = 4

One node (2) matches cur, and the other (4) is in the right subtree.

LCA is node 2.

